str(ITSseq)
chromatogram(ITSseq, width=250, height= 2, showcalls= "both")
BiocManager::install("Biostrings")
library(Biostrings)
dna_string<- DNAString(as.character(sequence))
dna_string <- DNAString(as.character(sequence))
SeqX<-makeBaseCalls(ITSseq)print(SeqX)
SeqX<-makeBaseCalls(ITSseq)
print(SeqX)
dna_string<- DNAString(as.character(ITS))
dna_string<- DNAString(as.character(ITSseq))
dna_string<- DNAString(as.character( SeqX))
dna_string<- DNAString(as.character(GAGGATGCTACTCATGACTATCTCACTACTGCCTCCTTGGTGTCTGAGAGGAGCGCTTGNATATGTGACCGGAAGCCGNGAGNTTGCTGGTGGGGGCCCCAAAAAGACACTTTNCNGGGTTTGTGCACGAGTATTTTGGTCGAGGGCGTTTTGCGAGGCTTCTCGCCCGGTTGNGGGGGAAGAGGTGGCATCAAGCTGCAGGCGCACTGTTGGGTCCGAGACAACAGGCCTNTGGTNCTTGACNGGGGGGTTGGGATAGGTNGTTGTCGCTCCACCTCGGTGGGGTGGGGTGGGGTTTGT))
ab1_file_A01 <- read.abif("F11L_A01_015.ab1")
sanger_seq <- sangerseq(ab1_file_A01)
sequence <- primarySeq(sanger_seq)
dna_string <- DNAString(as.character(sequence))
fasta <- DNAStringSet(dna_string)
fasta <- DNAStringSet(dna_string)
names(fasta) <- "Sample_1"
writeXStringSet(fasta, filepath = "A01_sequence.fasta")
getwd()
setwd("/Users/froglord/Desktop/4-11-25-10_MYCOITS-VP-DS")
ab1_files,- list.files(pattern = "\\.ab1$")
ab1_files <- list.files(pattern = "\\.ab1$")
for (file in ab1_files) {}
for (file in ab1_files) { }
ab1_files <- list.files(pattern = "\\.ab1$")
for (file in ab1_files) {
##read chromatogram
ab1f_data<-read.ab1f(file)
##extract sequence
sequence<- sangerseq(ab1f_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<-file.path(output_dir, fasta_file)
wrtieXStringSet(fasta, filepath = FASTA_FILES)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(ab1f_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<-file.path(output_dir, fasta_file)
wrtieXStringSet(fasta, filepath = FASTA_FILES)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
View(ab1_file_A01)
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<-file.path(output_dir, fasta_file)
wrtieXStringSet(fasta, filepath = FASTA_FILES)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
##Create a folder for your fasta files to go to
output_directory<-"converted_fasta"
if(!dir.exists(output_directory)) {
dir.create(output_directory)
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<- file.path(output_dir, fasta_file)
wrtieXStringSet(fasta, filepath = FASTA_FILES)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
##Create a folder for your fasta files to go to
output_directory<-"converted_fasta"
if(!dir.exists(output_directory)) {
dir.create(output_directory)
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<- file.path(output_directory, fasta_file)
wrtieXStringSet(fasta, filepath = FASTA_FILES)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
##Create a folder for your fasta files to go to
output_directory<-"converted_fasta"
if(!dir.exists(output_directory)) {
dir.create(output_directory)
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<- file.path(output_directory, fasta_file)
writeXStringSet(fasta, filepath = FASTA_FILES)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
##Create a folder for your fasta files to go to
output_directory<-"converted_fasta"
if(!dir.exists(output_directory)) {
dir.create(output_directory)
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<- file.path(output_directory, fasta_file)
writeXStringSet(fasta, filepath = converted_fasta)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
output_directory<-"converted_fasta"
if(!dir.exists(output_directory)) {
dir.create(output_directory)
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<- file.path(output_directory, fasta_file)
writeXStringSet(fasta, filepath = output_directory)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
output_directory<-"converted_fasta"
if(!dir.exists(output_directory)) {
dir.create(output_directory)
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<- file.path(output_directory, fasta_file)
writeXStringSet(fasta, filepath = fasta_path)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_fpath,"\n")
}
output_directory<-"converted_fasta"
if(!dir.exists(output_directory)) {
dir.create(output_directory)
}
##get list of ab1 files
ab1_files <- list.files(pattern = "\\.ab1$")
##for loop to process all files and convert into a FASTA format
for (file in ab1_files) {
##read chromatogram
abif_data<-read.abif(file)
##extract sequence
sequence<- sangerseq(abif_data)
#get primary DNA sequence
dna_seq<- primarySeq(sequence)
#convert to DNAStringSet -> fasta
fasta<- DNAStringSet(dna_seq)
#name sequence without .ab1 file
sample_name <- tools::file_path_sans_ext(basename(file))
names(fasta)<- sample_name
#write to .fasta file
fasta_file<- paste0(sample_name,".fasta")
#save into output folder
fasta_path<- file.path(output_directory, fasta_file)
writeXStringSet(fasta, filepath = fasta_path)
##prints status message that keeps track of what has been converted
cat("✅ Converted:", file, "→", fasta_path, "\n")
}
blastn -version
getwd()
BiocManager::install("rBLAST")
blastn -version
echo 'export PATH="$HOME/ncbi-blast-2.16.0+/bin:$PATH"' >> ~/.zshrc
blastn -version
##accessing rBLAST library to use tools like BLASTn
library(rBLAST)
getwd()##figure out which file you are in
blastn -version
system("blastn -version")
Sys.setenv(PATH = paste("/Users/froglord/ncbi-blast-2.16.0+/bin", Sys.getenv("PATH"), sep = ":"))
system("blastn -version")
open -e ~/.Renviron
BiocManager::install(c("bio3d", "seqinr"))
library(bio3d)
library(seqinr)
getwd()
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta")
library(readr)
files <- list.files("blast_results", pattern = "\\.txt$", full.names = TRUE)
accessions <- c(
"AM396443.1", #Mchelonae ITS1, 29/02
"AM396444.1", #Mchelonae ITS1, T5-2
"AM396445.1", #Mchelonae ITS1, T14
"AM396447.1", #Mmarinum ITS1, 2B
"AM396448.1", #Mmarinum ITS1, 9/04
"AM396449.1", #Mmarinum ITS1, 131/03
"AM902926.1", #Mfortuitum ITS1, S7
"AM902929.1", #Mfortuitum ITS1, 277/2/01
"AM902935.1"  #Mfortuitum ITS1, 276/3/01
)
species_lookup <- data.frame()
subject_id = accessions
species <- c(Mycobacterium chelonae ITS1 isolate 29/02,
species <- c("Mycobacterium chelonae ITS1 isolate 29/02",
"Mycobacterium chelonae ITS1 isolate T5-2",
"Mycobacterium chelonae ITS1 isolate T14",
"Mycobacterium marinum ITS1 isolate 2B",
"Mycobacterium marinum ITS isolate 9/04",
"Mycobacterium marinum ITS1 isolate 131/03",
"Mycobacterium fortuitum ITS1 strain S7",
"Mycobacterium fortuitum ITS1 strain 277/2/01",
"Mycobacterium fortuitum ITS1 strain 276/3/01")
species_lookup <- data.frame(
subject_id = "accessions"
species = "species"
species_lookup <- data.frame(
subject_id = "accessions",
species = "species"
)
library(dplyr)
blast_result <- read_tsv("your_blast_output.txt", col_names = FALSE, show_col_types = FALSE)
blast_result <- read_tsv("\\.txt$", col_names = FALSE, show_col_types = FALSE)
getwd()
setwd(/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta/blast_results)
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta/blast_results")
blast_result <- read_tsv("\\.txt$", col_names = FALSE, show_col_types = FALSE)
blast_result <- read_tsv("\\.txt$", col_names = FALSE, show_col_types = FALSE)
blast_result <- read_tsv( pattern="\\.txt$", col_names = FALSE, show_col_types = FALSE )
getwd()
library(readr)
getwd()
blast_result <- read_tsv("blast_results/my_blast_output.txt",
col_names = FALSE,
show_col_types = FALSE)
blast_result <- read_tsv("blast_results/"\\.txt$",
blast_txt_files <- list.files("blast_results", pattern = "\\.txt$", full.names = TRUE)
print(blast_txt_files)
getwd()
blast_result <- read_tsv("blast_results/"blast_txt_files"",
blast_result <- read_tsv("blast_results/"blast_txt_files"",  col_names = FALSE,
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta")
blast_txt_files <- list.files("blast_results", pattern = "\\.txt$", full.names = TRUE)
print(blast_txt_files)
blast_result <- read_tsv("blast_results/blast_text_files",
col_names = FALSE,
show_col_types = FALSE)
blast_result <- read_tsv("blast_results/"my_blast_output.txt"",
blast_result <- read_tsv("blast_txt_files",
col_names = FALSE,
show_col_types = FALSE)
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta/blast_results")
getwd()
blast_result <- read_tsv("blast_txt_files", col_names = FALSE, show_col_types = FALSE)
blast_result <- read_tsv(blast_txt_files, col_names = FALSE, show_col_types = FALSE)
colnames(blast_txt_files) <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
for (blast_txt_files in files) {
blast <- read_tsv(file, col_names = FALSE, show_col_types = FALSE)
colnames(blast) <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
for (blast_txt_files in files) {
blast <- read_tsv(file, col_names = FALSE, show_col_types = FALSE)
colnames(blast) <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
out_file <- sub("\\.txt$", ".csv", file)
write.csv(blast, out_file, row.names = FALSE)
cat("✅ Saved:", out_file, "\n")
}
for (blast_txt_files in files) {
blast <- read_tsv(file, col_names = FALSE, show_col_types = FALSE)
colnames(blast) <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
out_file <- sub("\\.txt$", ".csv", file)
write.csv(blast, out_file, row.names = FALSE)
cat("✅ Saved:", out_file, "\n")
}
read_tsv("blast_txt_files")
print(blast_txt_files)
blast_txt_files <- list.files("blast_results", pattern = "\\.txt$", full.names = TRUE)
print(blast_txt_files)
setwd()
getwd()
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta)
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta")
blast_txt_files <- list.files("blast_results", pattern = "\\.txt$", full.names = TRUE)
print(blast_txt_files)
for(blast_txt_files in files) {}
for (blast_txt_files in files) {
blast <- read_tsv(file, col_names = FALSE, show_col_types = FALSE)
colnames(blast) <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
out_file <- sub("\\.txt$", ".csv", file)
write.csv(blast, out_file, row.names = FALSE)
cat("✅ Saved:", out_file, "\n")
}
blast_all <- lapply(blast_txt_files, function(file) {
data <- read_tsv(blast_txt_files, col_names = FALSE, show_col_types = FALSE)
data$file <- basename(file)  # Add filename for traceability
return(data)
}) |> bind_rows()
print(blast_all)
colnames(blast_all)[1:9] <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
colnames(blast_all)[1:12] <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
write.csv(blast_all, "combined_blast_results.csv", row.names = FALSE)
print("combined_blast_results.csv")
install.packages(pheatmap)
library(pheatmap)
print(blast_txt_files)
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST/converted_fasta")
blast_txt_files <- list.files("blast_results", pattern = "\\.txt$", full.names = TRUE)
print(blast_txt_files)
blast_all <- lapply(blast_txt_files, function(file) {
data <- read_tsv(file, col_names = FALSE, show_col_types = FALSE)
data$file <- basename(file)  # Add filename for traceability
return(data)
}) |> bind_rows()
print(blast_all)
print(n = ...)
colnames(blast_all)[1:12] <- c(
"query_id", "subject_id", "percent_identity", "alignment_length",
"mismatches", "gap_opens", "q_start", "q_end",
"s_start", "s_end", "evalue", "bit_score"
)
write.csv(blast_all, "combined_blast_results.csv", row.names = FALSE)
getwd()
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/SANGER_TEST")
ITS<-read.abif("F11L_A01_015.ab1")
setwd("/Users/froglord/Desktop/SANGER-SEQUENCING/4-11-25-10_MYCOITS-VP-DS")
getwd()
ITS<-read.abif("F11L_A01_015.ab1")
plotChromatogram(ITS, width = 100, height = 2)
plotChromatogram("ITS", width = 100, height = 2)
library(sangerseqR)
plotChromatogram("ITS", width = 100, height = 2)
library(BiocManager)
plotChromatogram("ITS", width = 100, height = 2)
BiocManager::install(c("sangerseqR", "annotate", "Biostrings", "rBLAST", "bio3d", "seqinr"))
library(sangerseqR)
ab1_file <- readsangerseq("F11L_A01_015.ab1")
plotChromatogram(ab1_file, width = 100, height = 2)
##downloading libraries and packages
library(dplyr)
df<- read.csv("combined_blast_results.csv")
lookup <- data.frame(
subject_id = c(
"AM396443.1",
"AM396444.1",
"AM396445.1",
"AM396447.1",
"AM396448.1",
"AM396449.1",
"AM902926.1",
"AM902929.1",
"AM902935.1"
),
species = c(
"Mycobacterium chelonae ITS1, isolate 29/02",
"Mycobacterium chelonae ITS1, isolate T5-2",
"Mycobacterium chelonae ITS1, isolate T14",
"Mycobacterium marinum ITS1, isolate 2B",
"Mycobacterium marinum ITS1, isolate 9/04",
"Mycobacterium marinum ITS1, isolate 131/03",
"Mycobacterium fortuitum ITS1, strain S7",
"Mycobacterium fortuitum ITS1, strain 277/2/01",
"Mycobacterium fortuitum ITS1, strain 276/3/01"
)
)
git version
git --versio
